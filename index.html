<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Game Library</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <h1>My Game Library</h1>
    <input type="text" id="searchInput" onkeyup="filterGames()" placeholder="Search for a game...">
    <div id="loading">Loading all 6,000+ games, please wait...</div>
    <div id="galleryContainer"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/papaparse/5.4.1/papaparse.min.js"></script>

    <script>
        // No "DOMContentLoaded" listener is needed now, as the script is at the end.
        
        Papa.parse("games.csv", {
            download: true,
            header: true, // This line reads your header names
            skipEmptyLines: true, // This ignores any blank rows
            complete: function(results) {
                // Hide the loading message
                document.getElementById("loading").style.display = "none";
                // Build the gallery with the loaded data
                buildGallery(results.data);
            }
        });
        
        // This function builds the HTML for each game card
        function buildGallery(data) {
            const container = document.getElementById("galleryContainer");
            let allCardsHTML = ""; 

            data.forEach(game => {
                // This code reads the exact header names from your CSV
                const gameName = game.GameName;
                const posterUrl = game.PosterLink;

                // Make sure the row has a game name
                if (gameName) {
                    allCardsHTML += `
                        <div class="gameCard">
                            <img src="${posterUrl}" alt="${gameName} Poster" loading="lazy">
                            <h3>${gameName}</h3>
                        </div>
                    `;
                }
            });
            container.innerHTML = allCardsHTML;
        }

        // This function filters the gallery based on the search bar
        function filterGames() {
            const filter = document.getElementById("searchInput").value.toLowerCase();
            const cards = document.getElementsByClassName("gameCard");

            for (let i = 0; i < cards.length; i++) {
                const title = cards[i].getElementsByTagName("h3")[0];
                if (title.innerHTML.toLowerCase().includes(filter)) {
                    cards[i].style.display = "";
                } else {
                    cards[i].style.display = "none";
                }
            }
        }
    </script>

</body>
</html>
